
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Technician Repair Report</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; max-width: 1000px; margin: auto; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 6px; margin-top: 5px; }
        .section { margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; }
    </style>
</head>
<body>
    <h1>Technician Repair Report</h1>

    <div class="section">
        <h2>Upload Image for OCR1 (Info Plate)</h2>
        <input type="file" id="ocr1-upload" accept="image/*">
        <button type="button" onclick="runOCR1()">Extract Info from Plate</button>
        <pre id="ocr1-status"></pre>
    </div>

    <div class="section">
        <h2>Upload Image for OCR2 (Part Labels)</h2>
        <input type="file" id="ocr2-upload" accept="image/*">
        <button type="button" onclick="runOCR2()">Extract Info from Part</button>
        <pre id="ocr2-status"></pre>
    </div>

    <div class="section">
        <h2>General Information</h2>
        <label>CONTAINERNR</label>
        <input type="text">
        <label>DATUM</label>
        <input type="date">
        <label>NAAM (Technician Name)</label>
        <input type="text" placeholder="Auto-filled if logged in">
    </div>

    <div class="section">
        <h2>Temperature and Environment</h2>
        <label>SETPOINT Â°C</label>
        <input type="number">
        <label>VENTS</label>
        <input type="text">
        <label>CMH</label>
        <input type="text">
        <label>HUM</label>
        <input type="text">
        <label>AMBIENT</label>
        <input type="text">
        <label>SUPPLY (VOOR/NA)</label>
        <input type="number">
        <label>RETURN (VOOR/NA)</label>
        <input type="number">
    </div>

    <div class="section">
        <h2>Unit Identification (from OCR1)</h2>
        <label>MODEL</label>
        <input type="text" id="model_input">
        <label>DATUM IN DIENST</label>
        <input type="text" id="date_input">
        <label>SERIENR.</label>
        <input type="text" id="serial_input">
        <label>WARRANTY ID NR</label>
        <input type="text" id="warranty_id_input">
        <label>WARRANTY TAG NR</label>
        <input type="text" id="warranty_tag_input">
        <label>DATUM IN SERVICE</label>
        <input type="text" id="install_date_input">
        <label>GARANTIE</label>
        <input type="text">
        <label>AANTAL MAANDEN GARANTIE</label>
        <input type="text">
        <label>UNIT RUN TIME</label>
        <input type="text">
        <label>COMPRESSOR MOTOR HOURS</label>
        <input type="text">
    </div>

    <div class="section">
        <h2>Parts Replaced (from OCR2)</h2>
        <label>PARTNR.</label>
        <select>
            <option value="">Select Part Number</option>
        </select>
        <label>OMSCHRIJVING ONDERDEEL</label>
        <input type="text">
        <label>AANTAL</label>
        <input type="number">
        <label>SERIENR. DEFECT</label>
        <input type="text" id="defect_serial_input">
        <label>SERIENR. NIEUW</label>
        <input type="text" id="new_serial_input">
    </div>

    <div class="section">
        <h2>Additional Notes</h2>
        <label>ALARM(en)</label>
        <input type="text">
        <label>TEMPERATUUR IN-RANGE NA REPAIR</label>
        <input type="text">
        <label>OMSCHRIJVING / PROBLEEM / OPMERKINGEN</label>
        <textarea rows="5"></textarea>
    </div>

    <script>
        function runOCR1() {
            const file = document.getElementById('ocr1-upload').files[0];
            const status = document.getElementById('ocr1-status');
            if (!file) return alert("Upload an image first.");

            status.textContent = "Processing OCR1...";
            Tesseract.recognize(file, 'eng')
            .then(({ data: { text } }) => {
                status.textContent = text;
                document.getElementById('model_input').value = text.match(/Model Number:\s*([A-Z0-9\-]+)/i)?.[1] || '';
                document.getElementById('serial_input').value = text.match(/Serial Number:\s*([A-Z0-9]+)/i)?.[1] || '';
                document.getElementById('date_input').value = text.match(/Date of Manufacture:\s*([0-9\/]+)/i)?.[1] || '';
                document.getElementById('warranty_id_input').value = text.match(/Warranty.?ID.?Number.?[:\s]+(\d{7})/i)?.[1] || '';
                document.getElementById('warranty_tag_input').value = text.match(/Warranty Tag.?Number.?[:\s]+([A-Z0-9]+)/i)?.[1] || '';
                document.getElementById('install_date_input').value = text.match(/Date in Service:\s*([0-9\/]+)/i)?.[1] || '';
            })
            .catch(err => status.textContent = 'OCR1 failed: ' + err);
        }

        function runOCR2() {
            const file = document.getElementById('ocr2-upload').files[0];
            const status = document.getElementById('ocr2-status');
            if (!file) return alert("Upload a part photo first.");

            status.textContent = "Processing OCR2...";
            Tesseract.recognize(file, 'eng')
            .then(({ data: { text } }) => {
                status.textContent = text;
                document.getElementById('defect_serial_input').value = text.match(/Defect Serial[:\s]*([A-Z0-9]+)/i)?.[1] || '';
                document.getElementById('new_serial_input').value = text.match(/New Serial[:\s]*([A-Z0-9]+)/i)?.[1] || '';
            })
            .catch(err => status.textContent = 'OCR2 failed: ' + err);
        }
    </script>
</body>
</html>
