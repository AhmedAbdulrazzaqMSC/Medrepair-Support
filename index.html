
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Repair Report with Camera OCR</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.1/dist/tesseract.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    input, textarea, select, button { width: 100%; padding: 10px; margin: 10px 0; }
    img { max-width: 100%; margin-top: 10px; }
    .ocr-preview { margin-top: 20px; font-family: monospace; background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
    .section { margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px; }
  </style>
</head>
<body>
  <h1>Repair Report (OCR + Camera Capture)</h1>

  <div class="section">
    <h2>ðŸ“¸ Capture Info Plate (OCR1)</h2>
    <input type="file" accept="image/*" capture="environment" id="ocr1-upload" />
    <button onclick="runOCR1()">Run OCR</button>
    <img id="preview1" />
    <div id="ocr1-output" class="ocr-preview"></div>
  </div>

  <div class="section">
    <h2>Auto-filled Fields</h2>
    <label>Model Number</label>
    <input type="text" id="model">
    <label>Serial Number</label>
    <input type="text" id="serial">
    <label>Date of Manufacture</label>
    <input type="text" id="manufacture">
    <label>Warranty ID</label>
    <input type="text" id="warranty">
    <label>Refrigerant Type</label>
    <input type="text" id="refrigerant">
    <label>Date in Service</label>
    <input type="text" id="service">
  </div>

  <script>
    function runOCR1() {
      const fileInput = document.getElementById("ocr1-upload");
      const preview = document.getElementById("preview1");
      const output = document.getElementById("ocr1-output");

      if (!fileInput.files[0]) {
        alert("Please take or select a photo.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        preview.src = e.target.result;
        Tesseract.recognize(
          e.target.result,
          'eng',
          { logger: m => output.textContent = "â³ " + m.status + " " + (m.progress * 100).toFixed(0) + "%" }
        ).then(({ data: { text } }) => {
          output.textContent = text;

          document.getElementById("model").value = (text.match(/Model Number[:\s]*([\w\-\/]+)/i) || [])[1] || "";
          document.getElementById("serial").value = (text.match(/Serial Number[:\s]*([\w\-\/]+)/i) || [])[1] || "";
          document.getElementById("manufacture").value = (text.match(/Date of Manufacture[:\s]*([\w\-\/]+)/i) || [])[1] || "";
          document.getElementById("warranty").value = (text.match(/Warranty ID Number[:\s]*([\d]+)/i) || [])[1] || "";
          document.getElementById("refrigerant").value = (text.match(/Refrigerant[:\s]*([A-Z0-9\-]+)/i) || [])[1] || "";
          document.getElementById("service").value = (text.match(/Date In Service[:\s]*([\w\-\/]+)/i) || [])[1] || "";
        });
      };
      reader.readAsDataURL(fileInput.files[0]);
    }
  </script>
</body>
</html>
